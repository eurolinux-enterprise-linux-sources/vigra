curdir=$(vigra_testdir)/convolution

TESTIMAGES = lenna128.xv lenna_simple_sharpening_orig.xv lenna_gaussian_sharpening_orig.xv \
lenna128sepgrad.xv lennahessxx.xv lennastxx.xv lenna128recgrad.xv lenna128nonlinear.xv \
resampling.xv lennahessyy.xv lennastyy.xv lennahessxy.xv lennastxy.xv lenna128rgb.xv \
lenna128rgbsepgrad.xv lenna_level-2.xv lenna_level-1.xv lenna_level1.xv lenna_level2.xv \
lenna_levellap0.xv lenna_levellap1.xv lenna_levellap2.xv lennargbst.xv


test: test.o $(TESTIMAGES) $(PREINSTALL_IMPEX_LIB)
	$(CXX) -o test test.o $(PREINSTALL_IMPEX_LIB) $(IMPEX_DEPLIBS)
	./test || { rm ./test$(EXEEXT) ; exit 1; }

convolution.exe: test.d
	devenv "..\test.sln" /build Release /project convolution
	./convolution.exe || { rm ./convolution.exe ; exit 1; }

$(TESTIMAGES):
	ln -s $(curdir)/$@ .

include ../Makefile.include

ifneq "$(MAKECMDGOALS)" "clean"
include test.d
endif
